---
title: "Lab 3 - Multivariate Statistical Methods"
author: "Gustav Sternel√∂v"
date: "30 november 2015"
output:
  pdf_document:
    fig_height: 4
    fig_width: 7
---

# Assignment 1
## a)
The sample correlation matrix R:  
```{r, echo=FALSE}
### a)
# Reads in data
data <- "C:/Users/Gustav/Documents/732A37-Multivariate-Statistical-Methods/Lab1/data.dat"
data <- read.delim(data, header=FALSE)
names(data) <- c("Country", "100", "200", "400", "800", "1500", "3000", "Marathon")
corrMat <- cor(data[,2:8])
corrMat
```
The eigenvalues:  
```{r,echo=FALSE}
unlist(eigen(corrMat)[1])
```

The eigenvectors:  
```{r,echo=FALSE}
data.frame(eigen(corrMat)[2])
```


## b)
The first two principal components for the standardized variables are determined. The correlations between the standardized variables are shown in the table below.
```{r, echo=FALSE}
dataSc <- data.frame(scale(data[,2:8], center=TRUE, scale=TRUE))
prComp <- prcomp(dataSc, center=FALSE, scale=FALSE)
# correlation between first two principal components and the standardized variable
# correlation with what? The scores? loadings? 
cor(data.frame(prComp$x[,1], prComp$x[,2]), dataSc)
# variation explained by PC1 and PC2
lambda=prComp$sdev^2
#sprintf("%2.3f",lambda/sum(lambda)*100)[1:2]
```
The first component explains 82.966 % of the sample variance and the second component explains 8.981 % of the sample variance. The cumulative % of the sample variance explained by the two components then is 91.947 %. 

## c)
The principal components are shown in a table below. These components are interpretet by looking at the values in the table, but also by a plot where the scores for each country for the respective component are plotted against each other.  
```{r, echo=FALSE}
prComp$rotation[,1:2]
```

```{r, echo=FALSE, warning=FALSE}
pcScores <- data.frame(PC1=prComp$x[,1], PC2=prComp$x[,2], country=data[,1])
library(ggplot2)
ggplot(pcScores, aes(x=PC1, y=PC2)) + geom_point() + geom_text(aes(label=country))
```
The first principal component seem to measure the excellence of a nation since countries like USA, Germany and Russia, well-known top nations, are among those with the highest scores and less well-known countries in the field of athletics like Samoa and Cook Islands have the lowest scores.  
Regarding the second component the values points out the relative strength for a country in shorter versus longer running distances. If a country is better at shorter distances it obtains a lower value and if it is better at longer distances the value becomes higher. If the difference between how well the country performs at shorter and longer distances is small, the value for the second component also will become small. 

## d)
The first column in the table below gives the 6 highest scores for PC1 and the second column the countries who have the highest scores. The third column gives the 6 lowest scores in descending order and the fourth the countries who have the lowest scores. 
```{r, echo=FALSE}
TopNat <- pcScores[order(-pcScores$PC1),]
Head <- head(TopNat[,c(1,3)])
Tail <- tail(TopNat[,c(1,3)])
data.frame(cbind(Head, Tail), row.names=NULL)
```
When athletic excellence is compared between countries, the ones who have the highest scores are all well-known top nations. The reverse can be said about the countries with the lowest scores since they are fairly small countries who cannot compete with USA, Germany and so on when athletic excellence is compared.  

# Assignment 2

